define(["libs","cBase","cStore"],function(a,b,c){var d=b.Class(c,{__propertys__:function(){this.key="WXCSHTML",this.lifeTime="1D"},initialize:function(a,b){a(b)}}).getInstance(),e=function(){var a=d.get(),b=utils.getUrlParam("usessionid"),c=utils.getUrlParam("ticket",!0),e=utils.getUrlParam("sticket"),a=utils.getStorage("YDWXCS");a=a?a:{};var f=1,g=1,h=0,i=utils.getUrlParam("AreaCode",!0),j=utils.getUrlParam("portaltype",!0),k=null;switch(null!=j?0==j||1==j?k="wap":2==j&&(k="app"):a&&a.data&&a.data&&(k=a.data.IsHead?"wap":"app"),a&&a.data&&(a.data.Foot&&(f=0,"wap"==k&&$("#ydwxcsF").html(a.data.Foot)),(null==i||0==i.length)&&(i=a.data.AreaCode),h=a.data.IsLogin,a.data.IsFoot||(f=0),a.data.IsHead||(g=0),b||(b=a.usessionid),c||(c=a.ticket),e||(e=a.sticket),utils.setStorage("YDWXCS",JSON.stringify(a))),j){case"0":case"1":f=1,g=1;break;case"2":f=0,g=0}var l={SourceId:SALES.data.sourceid,Sales:SALES.data.sales,AreaCode:i,UseSsionid:b,Ticket:c,IsFoot:f,IsHead:g,IsLogin:h,STicket:e};if(null!=c&&null!=i&&0>=h&&utils.removeStorage("USERINFO",!0),b&&c){var m="http://"+window.location.host+"/html5/";window.location.href="http://120.197.232.22:80/sso-core/singlesignon?backurl="+m+"&portaltype=x"}$.ajax({url:"/html5/Other/GetWCityData",data:l,type:"post",dataType:"json",success:function(d){if(d&&d.Data){SALES.timeout=d.Data.ExpiredTime,SALES.timeby=!0,utils.setStorage("SALES",JSON.stringify(SALES));var f=null;if(a&&a.data&&a.data.Foot&&(f=a.data.Foot),a={timeout:d.ExpiredTime,data:d.Data,timeby:1},d.Data.Head&&($("#ydwxcsH").html(d.Data.Head),a.data.CityName=$("a.cityon").html()),d.Data.Foot&&"wap"==k&&$("#ydwxcsF").html(d.Data.Foot),b&&c&&(a.usessionid=b,a.ticket=c),e&&(a.sticket=e),d.User){var g={timeout:d.User.ExpiredTime,data:d.User};a.data.IsLogin=1,utils.setStorage("USERINFO",JSON.stringify(g))}a.data.Foot||(a.data.Foot=f),utils.setStorage("YDWXCS",JSON.stringify(a))}},error:function(){}})};return function(){e(function(a){alert(a)})}});