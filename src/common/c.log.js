define(["libs"],function(){window.onerror=function(a,b,c){cLog.errorLog(a,b,c)},window.onload=function(){cLog.urlLog(window.location.href)},window.onhashchange=function(){cLog.urlLog(window.location.href)};var cLog={serverLog:function(){var a=!1,b=localStorage.getItem("H5_CFG");return b&&(a=JSON.parse(b).value.serverLog),!!a}(),errorLog:function(a,b,c){var d=this.buildErrorObj(a,b,c);return this.pushLog("ERROR_LOG",d),!1},urlLog:function(a){if(!(a.indexOf("monitor")>-1)){var b={url:a,dt:this.getDateTime()};this.pushLog("URL_LOG",b)}},restlog:function(a,b,c){if(this.serverLog){var d={url:a,rspCode:c?"200":"404",req:b,rsp:c,dt:this.getDateTime()};this.pushLog("SERVER_LOG",d)}},applog:function(name,param){var logStore=localStorage.getItem("APP_LOG"),appLog=logStore?JSON.parse(logStore):{};appLog[name]={data:param,dt:this.getDateTime()},logStr=JSON.stringify?JSON.stringify(appLog):eval("("+appLog+")"),localStorage.setItem("APP_LOG",logStr)},buildErrorObj:function(a,b,c){var d="string"==typeof b?b.substr(b.lastIndexOf("/")+1):"";return{msg:a,file:d,line:c,fullPath:b,dt:this.getDateTime(),url:window.location.href,restful:{url:"",request:"",response:""}}},pushLog:function(logName,logItem){var logStore=localStorage.getItem(logName),logStr=[],logStack=logStore?JSON.parse(logStore):[];logStack.length>0&&logStack.splice(50),logStack.unshift(logItem),logStr=JSON.stringify?JSON.stringify(logStack):eval("("+logStack+")"),localStorage.setItem(logName,logStr)},getDateTime:function(){var a=new Date,b="";return b+=a.getMonth()+1,b+="/",b+=a.getDate(),b+=" ",b+=a.getHours(),b+=":",b+=a.getMinutes(),b+=":",b+=a.getSeconds()}};return cLog});