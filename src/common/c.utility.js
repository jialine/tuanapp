define(["libs","cBase","cStorage"],function(a,b,c){var d={},e=(Array.prototype.slice,Array.prototype.push,function(a){return Object.prototype.toString.call(a)}),f=(b.Date,c.localStorage);return d.JsonArrayToObject=function(a){if(!a)return[];for(var b,c=a.shift(),f=[],g=0,h=a.length;h>g;g++){b={};for(var i=0,j=a[g].length;j>i;i++)switch(e(a[g][i])){case"[object Array]":b[c[i]]=d.JsonArrayToObject(a[g][i]);break;default:b[c[i]]=a[g][i]}f.push(b)}return f},d.mix=function(a,b,c){a=a||{},b=b||{};for(var d in b)b.hasOwnProperty(d)&&(c?null!==b[d]&&(a[d]=b[d]):a[d]=b[d]);return a},d.indexOf=function(a,b){var c,d=-1;for(c=0;c<b.length;c++)if(b[c]===a){d=c;break}return d},d.each=function(a,b,c){a=a||{},b=b||function(){};var d,e=Object.prototype.toString.call(a);if("[object Array]"===e)for(d=0;d<a.length;d++)b.call(c||a[d],d,a[d]);else if("[object Object]"===e)for(d in a)a.hasOwnProperty(d)&&b.call(c||a[d],d,a[d])},d.grep=function(a,b,c){var d;a=a||{},b=b||function(){};var e,f=Object.prototype.toString.call(a);if("[object Array]"===f)for(d=[],e=0;e<a.length;e++)b(a[e],e)&&d.push(a[e]);else if("[object Object]"===f){d=c?[]:{};for(e in a)a.hasOwnProperty(e)&&b(a[e],e)&&(c?d.push(a[e]):d[e]=a[e])}return d},d.deleteValue=function(a,b){var c=d.indexOf(a,b);return c>-1?b.splice(c,1):null},d.getGuid=function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function b(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}var c=localStorage.GUID||"";return c||(c=b(),localStorage.GUID=c),c},d.trim=function(){return function(a){return a.replace(/(^[\s\u3000]*)|([\s\u3000]*$)/g,"")}},d.stripTags=function(a){return(a||"").replace(/<[^>]+>/g,"")},d.jsonToQuery=function(){var a=function(a,b){return a=null==a?"":a,a=d.trim(a.toString()),b?encodeURIComponent(a):a};return function(b,c){var d=[];if("object"==typeof b)for(var e in b)if(b[e]instanceof Array)for(var f=0,g=b[e].length;g>f;f++)d.push(e+"="+a(b[e][f],c));else"function"!=typeof b[e]&&d.push(e+"="+a(b[e],c));return d.length?d.join("&"):""}}(),d.queryToJson=function(){function a(a){return"[object Array]"===Object.prototype.toString.call(a)}return function(b,c){for(var e=d.trim(b).split("&"),f={},g=function(a){return c?decodeURIComponent(a):a},h=0,i=e.length;i>h;h++)e[h]&&(_hsh=e[h].split("="),_key=_hsh[0],_value=_hsh[1],_hsh.length<2&&(_value=_key,_key="$nullName"),f[_key]?(1!=a(f[_key])&&(f[_key]=[f[_key]]),f[_key].push(g(_value))):f[_key]=g(_value));return f}}(),d.validate=function(){var a=function(){};$.each("String Function Boolean RegExp Number Date Object Null Undefined".split(" "),function(b,c){var d;switch(c){case"Null":d=function(a){return null===a};break;case"Undefined":d=function(a){return void 0===a};break;default:d=function(a){return new RegExp(c+"]","i").test(e(a))}}a["is"+c]=d});var b={Email:/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/,Qq:/^[1-9]\d{4,}$/,Phone:/^[0-9]{3,4}-[0-9]{7,8}$/,Url:/^http(s)?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\:+!]*([^<>])*$/,Mobile:/^1\d{10}/,Postcode:/^\d{6}$/,IP:function(b){if(!b||a.isNull(b))return!1;var c=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/g;return c.test(b)&&RegExp.$1<256&&RegExp.$2<256&&RegExp.$3<256&&RegExp.$4<256?!0:!1},EmptyObject:function(a){for(var b in a)return!1;return!0},IdCard:function(a){var a,b,c,d,e,f={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"xinjiang",71:"台湾",81:"香港",82:"澳门",91:"国外"},g=new Array;if(g=a.split(""),null==f[parseInt(a.substr(0,2))])return!1;switch(a.length){case 18:return ereg=parseInt(a.substr(6,4))%4==0||parseInt(a.substr(6,4))%100==0&&parseInt(a.substr(6,4))%4==0?/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/:/^[1-9][0-9]{5}(19|20)[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/,ereg.test(a)?(d=7*(parseInt(g[0])+parseInt(g[10]))+9*(parseInt(g[1])+parseInt(g[11]))+10*(parseInt(g[2])+parseInt(g[12]))+5*(parseInt(g[3])+parseInt(g[13]))+8*(parseInt(g[4])+parseInt(g[14]))+4*(parseInt(g[5])+parseInt(g[15]))+2*(parseInt(g[6])+parseInt(g[16]))+1*parseInt(g[7])+6*parseInt(g[8])+3*parseInt(g[9]),b=d%11,e="F",c="10X98765432",e=c.substr(b,1),e.toUpperCase()==g[17].toUpperCase()?!0:!1):!1;default:return!1}},CharsLenWithinRange:function(b,c){if(!a.isString(b))return!1;var d=b.match(/\W/g),e=null==d?b.length:b.length+d.length;return(isValidate=e>=0&&c>=e)?(this.cutLen=b.length,!0):!1},ContactName:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,26):!1},BookPS:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,100):!1},InvTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,100):!1},BoardTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,40):!1},AreaTitle:function(c){return a.isString(c)?b.CharsLenWithinRange.call(this,c,80):!1},MobileNumber:function(b){if(!a.isString(b))return!1;var c=11;return b.length==c&&/^(\d| )+$/g.test(b)},FlightNumber:function(b){if(!a.isString(b))return!1;var c=3,d=7;return b.length>=c&&b.length<=d&&/^(\d|\w)+$/g.test(b)}};return $.each(b,function(b,c){a["is"+b]=function(b){return!b||a.isNull(b)||a.isNull(c)?!1:a.isFunction(c)?c.call(this,b):a.isRegExp(c)?c.test(b):!1}}),a}(),d.cookie=function(){var a={};return a.getCookie=function(a){a=a.replace(/([\.\[\]\$])/g,"\\$1");var b=new RegExp(a+"=([^;]*)?;","i"),c=document.cookie+";",d=c.match(b);return d?unescape(d[1])||"":""},a.setCookie=function(a,b,c,d,e,f){var g=[];if(g.push(a+"="+escape(b)),c){var h=new Date,i=h.getTime()+36e5*c;h.setTime(i),g.push("expires="+h.toGMTString())}d&&g.push("path="+d),e&&g.push("domain="+e),f&&g.push(f),document.cookie=g.join(";")},a.deleteCookie=function(a){document.cookie=a+"=;expires=Fri, 31 Dec 1999 23:59:59 GMT;"},a}(),d.dateParse=function(a){var b=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+$");if("string"==typeof a){if(b.test(a)||isNaN(Date.parse(a))){var c=a.split(/ |T/),d=c.length>1?c[1].split(/[^\d]/):[0,0,0],e=c[0].split(/[^\d]/);return new Date(e[0]-0,e[1]-1,e[2]-0,d[0]-0,d[1]-0,d[2]-0)}return new Date(a)}return new Date},d.getServerTime=function(){var a=d.cookie.getCookie("WAP_SERVERDATE");return d.dateParse(a)},d.getServerDate=function(a){return b.getServerDate(a)},d.isInApp=function(){var a=window.navigator.userAgent;if(a.indexOf("CtripWireless")>-1)return!0;var b=f.oldGet("isInApp");if(b)return"1"==b?!0:!1;var c=f.oldGet("ISINAPP");return c?"1"==c?!0:!1:void 0},d.isPreProduction=function(){var a=f.oldGet("isPreProduction");return a},d.Object={set:function(a,b,c){if(!b)return null;var d=b.split(".");a=a||{},tmp=a;for(var e=0,f=d.length,g=Math.max(f-1,0);f>e;e++)g>e?tmp=tmp[d[e]]=tmp[d[e]]||{}:tmp[d[e]]=c;return a},get:function(a,b){if(!a||!b)return null;var c=b.split(".");a=a||{},tmp=a;var d=0,e=c.length;for(Math.max(e-1,0);e>d;d++)if(tmp=tmp[c[d]],"null"==typeof tmp||"undefined"==typeof tmp)return null;return tmp}},d.SimpleQueue=new b.Class({initialize:function(){this.index=0,this.handlers=[],this.isStart=!1},add:function(a){this.handlers.push(a),this.isStart||(this.isStart=!0,this._next())},_next:function(a){var b=this.handlers.shift();b&&b.call(this,this,a)},next:function(){this._next.apply(this,arguments),this.stop()},stop:function(){this.isStart=!1}}),d.tryUrl=function(a){var b=document.createElement("iframe");b.height=1,b.width=1,b.frameBorder=0,b.style.position="absolute",b.style.left="-9999px",b.style.top="-9999px",document.body.appendChild(b),d.tryUrl=function(a){b.src=a},d.tryUrl(a)},d});