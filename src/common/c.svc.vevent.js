define(["libs","cBase","cStorage","cAjax","cUtility"],function(a,b,c,d,e){var f=b;f.utils=e;var g=c.localStorage,h={};return h.SvcVEvent={baseUrl:"",getCityInfo:function(){var a=g.get("VEVENTCITYINFO");return a||(a={City:"sanya",CityName:"三亚",DepartCity:"2",SourceId:3454}),"string"==typeof a&&"{"===a.charAt(0)&&(a=JSON.parse(a)),a},setCityInfo:function(a){var b=h.SvcVEvent.getCityInfo();a=a||{};for(var c in a)b[c]=a[c];g.set("VEVENTCITYINFO",b,(new f.Date).addDay(15).valueOf())},getAjaxResourceList:function(a,b,c){var e=h.SvcVEvent.baseUrl+"/html5/Vacation/GetProVacationList/"+a,g={};return d.post(e,g,function(a){if(1==a.ServerCode){var d=a.Data&&a.Data.length?f.utils.JsonArrayToObject(a.Data)[0]:null;b(d,a)}else c&&c(a)},function(a){c&&c(a)})},getResourceList:function(a,b,c){var d="RESOURCELISTDATA",e=g.get(d);return e?(b&&b(e),void 0):h.SvcVEvent.getAjaxResourceList(a,function(a){g.set(d,a,(new f.Date).addMinutes(3).valueOf()),b&&b(a)},c)},getAjaxResourceDetail:function(a,b,c){var e="/html5/Vacation/GetVacationDetail";return a=a||{DepartCityId:2,Id:2},d.post(e,a,function(a){1==a.ServerCode?b(f.utils.JsonArrayToObject(a.Data)[0],a):c&&c(a)},function(a){c&&c(a)})},getResourceDetail:function(a,b,c){var d="REROURCEDETAILDATA",e=g.get(d),i=JSON.stringify(a);return e&&e.params===i?(b&&b(e.data),void 0):h.SvcVEvent.getAjaxResourceDetail(a,function(a){var c={data:a,params:i};g.set(d,c,(new f.Date).addMinutes(3).valueOf()),b&&b(a)},c)},setPromotionInfo:function(a,b){a&&b&&(a.ResourceId=b),g.set("PROMOTIONINFO",a)},getPromotionInfo:function(a){var b=g.get("PROMOTIONINFO");return a&&b&&a!==b.ResourceId?null:b},getVerifyCode:function(a,b,c){var e="/html5/ClientData/GetVerifyCode/",f={Mobile:a,CodeType:2};return d.post(e,f,function(a){b(a)},function(a){console.log("error:"+a),"function"==typeof c&&c(a)})},checkVerifyCode:function(a,b,c,e){var f="/html5/Custom/CheckVerifyCode",g={Mobile:a,VerifyCode:b};return d.post(f,g,function(a){c(a)},function(a){"function"==typeof e&&e(a)})},getVEventOrders:function(a,b,c,e){var h="/html5/Custom/GetTravelNonOrder",i={Mobile:a,VerifyCode:b,CodeType:2};return d.post(h,i,function(a){g.set("VEVENTORDERDATA",a,new f.Date(new Date).addMinutes(30)),c(a)},function(a){"function"==typeof e&&e(a)})},getTravelNonOrderDetail:function(a,b,c,e,f){var g="/html5/Custom/GetTravelNonOrderDetail",h={Mobile:a,VerifyCode:b,OrderId:c,CodeType:2};return d.post(g,h,function(a){e(a)},function(a){"function"==typeof f&&f(a)})},getVacationDayPrice:function(a,b,c,e){var f="/html5/Vacation/GetVacationTicketPriceList",g={ProductId:a,TicketId:b};return d.post(f,g,function(a){c(a)},function(a){"function"==typeof e&&e(a)})},SubmitTravelOrder:function(a,b,c){for(var e="/html5/Vacation/SubmitTravelOrder",f=[],g=0,h=a.tickets.length;h>g;g++)0!=a.tickets[g].num&&(f[g]={TicketId:a.tickets[g].ticketid,UseDate:a.tickets[g].usedate,Price:a.tickets[g].pricediscount,PriceDiscount:a.tickets[g].price,Amount:a.tickets[g].ticketamount,Qty:a.tickets[g].num});var i={ProductID:a.productid,DepartCityID:this.getCityInfo().DepartCity,Amount:a.totalamount,ContactName:a.contactname,ContactMobile:a.contactmobile,ProductList:f,PromotionID:a.PromotionID};return d.post(e,i,function(a){b(a)},function(a){"function"==typeof c&&c(a)})},getAjaxTicketDetail:function(a,b,c){var e="/html5/Vacation/GetVacationTicketDetail";return a=a||{Flag:1,TicketId:null},d.post(e,a,function(a){1==a.ServerCode?b(a.Data,a):c&&c(a)},function(a){c&&c(a)})},getTicketDetail:function(a,b,c){var d="TICKETDETAILDATA",e=g.get(d),i=JSON.stringify(a);return e&&e.params===i?(b&&b(e.data),void 0):h.SvcVEvent.getAjaxTicketDetail(a,function(a){var c={data:a,params:i};g.set(d,c,(new f.Date).addMinutes(3).valueOf()),b&&b(a)},c)}},h});