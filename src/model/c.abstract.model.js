define(["libs","cBase","cAjax","cUtility","cLog"],function(a,b,c,d,e){var f=(d.Object,new b.Class({__propertys__:function(){this.url=null,this.param=null,this.dataformat=null,this.validates=[],this.debug=!1,this.protocol="http",this.contentType=f.CONTENT_TYPE_JSON,this.method="POST",this.ajax,this.isAbort=!1,this.onBeforeCompleteCallback=null},initialize:function(a){this.assert();for(var b in a)this[b]=a[b]},assert:function(){if(null===this.url)throw"not override url property";if(null===this.param)throw"not override param property"},pushValidates:function(a){"function"==typeof a&&this.validates.push($.proxy(a,this))},setParam:function(a,b){"object"!=typeof a||b?this.param[a]=b:this.param=a},getParam:function(){return this.param},buildurl:function(){var a=f.baseurl(this.protocol);return this.protocol+"://"+a.domain+"/"+a.path+("function"==typeof this.url?this.url():this.url)},execute:function(a,b,d,g,h){this.isAbort=!1;var i=this.buildurl(),j=this,k=$.proxy(function(c){if(e.restlog(j.buildurl(),j.getParam(),c),this.validates&&this.validates.length>0)for(var f=0,g=this.validates.length;g>f;f++)if(!this.validates[f](c))return"function"==typeof b?b.call(d||this,c):!1;var h="function"==typeof this.dataformat?this.dataformat(c):c;"function"==typeof this.onBeforeCompleteCallback&&this.onBeforeCompleteCallback(h),"function"==typeof a&&a.call(d||this,h,c)},this),l=$.proxy(function(a){return e.restlog(j.buildurl(),j.getParam()),j.isAbort?(j.isAbort=!1,"function"==typeof g?g.call(d||this,a):!1):("function"==typeof b&&b.call(d||this,a),void 0)},this),h=h||_.clone(this.getParam()||{});return this.ajax=this.contentType===f.CONTENT_TYPE_JSON?c.cros(i,this.method,h,k,l):this.contentType===f.CONTENT_TYPE_JSONP?c.jsonp(i,h,k,l):c.post(i,h,k,l)},abort:function(){this.isAbort=!0,this.ajax&&this.ajax.abort&&this.ajax.abort()}}));return f.getInstance=function(){return this.instance instanceof this?this.instance:this.instance=new this},f.baseurl=function(){throw"[ERROR]abstract method:baseurl, must be override"},f.CONTENT_TYPE_JSON="json",f.CONTENT_TYPE_FORM="form",f.CONTENT_TYPE_JSONP="jsonp",f});