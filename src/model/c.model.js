define(["libs","cBase","cStore","cAjax","cUtility","CommonStore","cAbstractModel","cStorage"],function(a,b,c,d,e,f,g,h){var i=e.Object,j=new b.Class(g,{__propertys__:function(){this.usehead=!0,this.head=f.HeadStore.getInstance(),this.result=null,this.headinfo=null,this.ajaxOnly=!1},initialize:function(a,b){a(b),this.baseurl=j.baseurl.call(this,this.protocol)},setHead:function(a){if(!a instanceof c)throw"Set head is not a store";this.head=a},getHead:function(){return this.head},getParamStore:function(){return this.param},setParamStore:function(a){if("object"!=typeof a)throw"Set param is not a store";this.param=a},getResultStore:function(){return this.result},clearResult:function(){this.result&&"function"==typeof this.result.remove&&this.result.remove()},setParam:function(a,b){var d={};"object"!=typeof a||b?d[a]=b:d=a;for(var e in d)this.param instanceof c?this.param.setAttr(e,d[e]):i.set(this.param,e,d[e])},getParam:function(){return this.param instanceof c?this.param.get():this.param},buildurl:function(){var a,b=h.localStorage.get("H5_CFG");b&&b.path&&(a=b.path);var c=this.baseurl,d=[];a&&!location.host.match(/^m\.ctrip\.com/i)&&(d="http"===this.protocol?a.http&&a.http.split("/"):a.https&&a.https.split("/"));var e=this.protocol+"://"+(d[0]||c.domain)+"/"+(d[1]||c.path)+("function"==typeof this.url?this.url():this.url);return e},getTag:function(){var a=_.clone(this.getParam()||{});if(this.isUserData&&!a.cid){var b=this.head.userStore;a.cid=b.getUserId()}return JSON.stringify(a)},excute:function(a,b,d,e,f){var g=_.clone(this.getParam()||{});this.pushValidates(function(a){var b=this.head.get(),c=a.head;return this.contentType!==j.CONTENT_TYPE_JSONP&&this.usehead&&c.auth&&c.auth!==b.auth&&this.head.setAuth(c.auth),c&&0===c.errcode?!0:!1});var h=this.getTag(),i=this.result&&this.result.get(h);!i||this.ajaxOnly||d?("get"!==this.method.toLowerCase()&&this.usehead&&this.contentType!==j.CONTENT_TYPE_JSONP?g.head=this.head.get():"get"===this.method.toLowerCase()||this.usehead||this.contentType===j.CONTENT_TYPE_JSONP||this.headinfo&&(g.head=this.headinfo),this.onBeforeCompleteCallback=function(a){this.result instanceof c&&this.result.set(a,h)},this.execute(a,b,e,f,g)):"function"==typeof a&&a.call(e||this,i)}});return j.baseurl=function(a){var b=location.host,c="m.ctrip.com",d="restapi";return e.isInApp()?"1"==e.isPreProduction()?c="https"==a?"wpg.ctrip.com":"m.ctrip.com":"0"==e.isPreProduction()?(c="https"==a?"restful.waptest.ctrip.com":"waptest.ctrip.com",d="restapi2"):c="https"==a?"wpg.ctrip.com":"m.ctrip.com":b.match(/^m\.ctrip\.com/i)?c="m.ctrip.com":!b.match(/^(localhost|172\.16|127\.0)/i)||"https"!=location.protocol&&"https"!=a?b.match(/^(localhost|172\.16|127\.0)/i)?(c="https"==a?"restful.waptest.ctrip.com":"waptest.ctrip.com",d="restapi2"):b.match(/^10\.8\.2\.111/i)?c="10.8.2.111":!b.match(/^waptest\.ctrip|^210\.13\.100\.191/i)||"https"!=location.protocol&&"https"!=a?b.match(/^waptest\.ctrip|^210\.13\.100\.191/i)?(c="waptest.ctrip.com",d="restapi2"):c="m.ctrip.com":(c="restful.waptest.ctrip.com",d="restapi2"):(c="restful.waptest.ctrip.com",d="restapi2"),{domain:c,path:d}},j});