define(["libs","cBase","cUIAbstractView","cUIMask"],function(a,b,c,d){var e={},f={prefix:"cui-"};return e.__propertys__=function(){this.tpl=this.template(['<div class="'+f.prefix+'layer-padding">','<div class="'+f.prefix+'layer-content"><%=content%></div>',"</div>"].join("")),this.content="",this.contentDom,this.mask=new d({classNames:[f.prefix+"opacitymask"]}),this.addClass(f.prefix+"layer"),this.viewdata={},this.windowResizeHander,this.setIntervalResource,this.setIntervalTotal=0},e.initialize=function(a,b){var c={content:!0};this.setOption(function(a,b){switch(!0){case c[a]:this[a]=b;break;case"class"===a:this.addClass(b)}}),this.bindEvent(),a(b),this.loadViewData()},e.loadViewData=function(){this.viewdata.content=this.content},e.setViewData=function(a){this.viewdata=cUtility.mix(this.viewdata,a),this.setRootHtml(this.createHtml())},e.bindEvent=function(){this.addEvent("onCreate",function(){this.windowResizeHander=$.proxy(this.reposition,this),this.contentDom=this.root.find("."+f.prefix+"layer-content")}),this.addEvent("onShow",function(){this.mask.show(),$(window).bind("resize",this.windowResizeHander),this.root.css("visibility","hidden"),this.reposition(),this.setIntervalResource=setInterval($.proxy(function(){this.setIntervalTotal<10?this.windowResizeHander():(this.setIntervalTotal=0,this.root.css("visibility","visible"),clearInterval(this.setIntervalResource)),this.setIntervalTotal++},this),1),this.setzIndexTop()}),this.addEvent("onHide",function(){$(window).unbind("resize",this.windowResizeHander),clearInterval(this.setIntervalResource),this.root.css("visibility","visible"),this.mask.hide()})},e.createHtml=function(){return this.tpl(this.viewdata)},e.maskToHide=function(a){this.mask.root.on("click",$.proxy(function(){this.hide(),"function"==typeof a&&a(),this.mask.root.off("click")},this)),this.mask.addEvent("onHide",function(){this.root.off("click"),this.root.remove()})},new b.Class(c,e)});