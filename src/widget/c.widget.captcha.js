define(["cWidgetFactory","cStorage","c"],function(a,b,c){"use strict";var d="Captcha",e=function(){};e={islock:!1,getCode:function(a,b){var d=this;d.islock||(b.showLoading(),this.islock=!0,a.excute(function(a){if(b.hideLoading(),d.islock=!1,0==a.rc)d.islock=!0,d.showtime(b.els.sendcodebtn);else if(2==a.rc){a.rmsg="很抱歉，您的验证次数已达上限，请明天再试";var e=new c.ui.Alert({message:a.rmsg,buttons:[{text:"确定",click:function(){this.hide();for(var a in b.els){var c=b.els[a][0];c&&"INPUT"==c.nodeName&&!c.disabled&&(c.value="")}}}]});e.show()}else a.rmsg=a.rmsg||"获取验证码失败，请重试",b.showToast(a.rmsg)},function(){d.islock=!1,b.hideLoading(),b.showToast("获取验证码失败，请重试")}))},showtime:function(a){var b=60,c=this;if(c.islock)var d=setInterval(function(){a.addClass("cgrey"),a.removeClass("cblue1"),a.text(b+"秒后重发"),(0>=b||!c.islock)&&(clearInterval(d),a.removeClass("cgrey"),a.addClass("cblue1"),a.text("免费获取"),c.islock=!1),b--},1e3)},setinit:function(){this.islock=!1}},a.register({name:d,fn:e})});