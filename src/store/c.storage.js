define(["cBase"],function(a){var b=window.JSON,c=a.Date,d=function(){function a(a,b,c,d,e){return{value:a,oldvalue:e||{},timeout:b,tag:c,savedate:d}}function d(a){this.proxy=a}return d.prototype={constructor:d,set:function(d,e,f,g,h,i){h=h||(new c).format("Y/m/d H:i:s"),f=f?new c(f):(new c).addDay(30);var j=a(e,f.format("Y/m/d H:i:s"),g,h,i);try{return this.proxy.setItem(d,b.stringify(j)),!0}catch(k){console&&console.log(k)}return!1},get:function(a,d,e){var f,g=null;try{f=this.proxy.getItem(a),f&&(f=b.parse(f),c.parse(f.timeout,!0)>=new Date&&(d?d===f.tag&&(g=e?f.oldvalue:f.value):g=e?f.oldvalue:f.value))}catch(h){console&&console.log(h)}return g},getTag:function(a){var c,d=null;try{c=this.proxy.getItem(a),c&&(c=b.parse(c),d=c&&c.tag)}catch(e){console&&console.log(e)}return d},getSaveDate:function(a,d){var e,f=null;try{e=this.proxy.getItem(a),e&&(e=b.parse(e),e.savedate&&(f=c.parse(e.savedate),d||(f=f.valueOf())))}catch(g){console&&console.log(g)}return f},getExpireTime:function(a){var c=null,d=null;try{c=this.proxy.getItem(a),c&&(c=b.parse(c),d=Date.parse(c.timeout))}catch(e){console&&console.log(e)}return d},remove:function(a){return this.proxy.removeItem(a)},getAll:function(){for(var a=this.proxy.length,b=[],c=0;a>c;c++){var d=this.proxy.key(c),e={key:d,value:this.get(d)};b.push(e)}return b},clear:function(){this.proxy.clear()}},{localStorage:new d(window.localStorage),sessionStorage:new d(window.sessionStorage)}}();return d.localStorage.oldGet=function(b){var c=localStorage.getItem(b),d=c?JSON.parse(c):null;if(d&&d.timeout){var e=new Date,f=a.Date.parse(d.timeout).valueOf();if(d.timeby){if(f-e>=0)return d}else if(f-a.Date.parse(a.Date.format(e,"Y-m-d")).valueOf()>=0)return d;return localStorage.removeItem(b),null}return d},d.localStorage.oldSet=function(a,b){localStorage.setItem(a,b)},d.localStorage.getExpireTime=function(b){var c=localStorage.getItem(b),d=c?JSON.parse(c):null;return d&&d.timeout?d.timeout:new a.Date(a.getServerDate()).addDay(2).format("Y-m-d")},d.localStorage.oldRemove=function(a){localStorage.removeItem(a)},d});